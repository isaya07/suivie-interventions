import{_ as D}from"./CyJ7lqwL.js";import{T as E}from"./Bo_PBiFp.js";import{r as h,j as V,l as B,c,b as r,a as t,w as l,o as d,t as a,i as s,k as T,s as S,F as N,m as z,p as F,g as I,h as L}from"./DYlgVOq5.js";import G from"./7fFrN4_w.js";import M from"./TkXTV1AA.js";import P from"./D5k--mLm.js";import{u as R}from"./DFhEUFyw.js";import{u as W}from"./BZoA-2F6.js";import"./TrVZK8xw.js";import"./8hyyyOHM.js";import"./BwzGxkg-.js";import"./CBaYzeil.js";import"./DlAUqK2U.js";import"./Bjy1Ed27.js";const H={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},q={class:"px-4 py-6 sm:px-0"},J={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},K={class:"flex items-center justify-center"},O={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Q={class:"flex items-center justify-center"},U={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},X={class:"flex items-center justify-center"},Y={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Z={class:"flex items-center justify-center"},tt={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},et={class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},st={class:"flex items-center justify-between p-4 border-b"},rt={key:0,class:"flex justify-center py-8"},nt={key:1,class:"p-4 space-y-4"},it={class:"flex items-center justify-between"},ot={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},lt={class:"flex items-center justify-between"},at={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},dt={class:"flex items-center justify-between"},ct={class:"text-sm font-medium text-gray-900 dark:text-gray-100"},ut={class:"flex items-center justify-between p-4 border-b"},pt={key:0,class:"flex justify-center py-8"},xt={key:1,class:"p-4 text-center text-gray-500 dark:text-gray-400"},mt={key:2,class:"p-4 space-y-4 max-h-80 overflow-y-auto"},gt=["onClick"],yt={class:"flex-shrink-0 mr-3"},vt={class:"flex-1 min-w-0"},ft={class:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate"},_t={class:"text-xs text-gray-500 dark:text-gray-400"},bt={class:"p-4"},kt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Lt={__name:"dashboard",setup(ht){const{user:v}=R(),{interventions:f,fetchInterventions:_,loading:b}=W(),n=h({total:0,enCours:0,terminees:0,enAttente:0}),x=h([]),w=i=>{switch(i){case"En cours":return"warning";case"Terminée":return"success";case"En attente":return"info";case"Annulée":return"danger";default:return"info"}},$=i=>new Date(i).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}),m=()=>{const i=[...f.value||[]];n.value={total:i.length,enCours:i.filter(e=>e.statut==="En cours").length,terminees:i.filter(e=>e.statut==="Terminée").length,enAttente:i.filter(e=>e.statut==="En attente").length},x.value=i.sort((e,g)=>new Date(g.date_creation)-new Date(e.date_creation)).slice(0,5)},j=async()=>{await _(),m()};return V(async()=>{await _(),m()}),B(f,m,{deep:!0}),(i,e)=>{const g=D,u=P,p=S,k=M,y=G,C=F,A=E;return d(),c("div",null,[r(g),t("main",H,[t("div",q,[e[21]||(e[21]=t("div",{class:"mb-8"},[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"Dashboard"),t("p",{class:"text-gray-600 dark:text-gray-400"},"Vue d'ensemble de vos interventions")],-1)),t("div",J,[r(u,{class:"text-center"},{content:l(()=>[t("div",K,[e[6]||(e[6]=t("div",{class:"p-3 bg-blue-100 rounded-full mr-4"},[t("i",{class:"pi pi-clipboard text-blue-600 text-xl"})],-1)),t("div",null,[t("div",O,a(s(n).total),1),e[5]||(e[5]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Total interventions",-1))])])]),_:1}),r(u,{class:"text-center"},{content:l(()=>[t("div",Q,[e[8]||(e[8]=t("div",{class:"p-3 bg-yellow-100 rounded-full mr-4"},[t("i",{class:"pi pi-clock text-yellow-600 text-xl"})],-1)),t("div",null,[t("div",U,a(s(n).enCours),1),e[7]||(e[7]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"En cours",-1))])])]),_:1}),r(u,{class:"text-center"},{content:l(()=>[t("div",X,[e[10]||(e[10]=t("div",{class:"p-3 bg-green-100 rounded-full mr-4"},[t("i",{class:"pi pi-check-circle text-green-600 text-xl"})],-1)),t("div",null,[t("div",Y,a(s(n).terminees),1),e[9]||(e[9]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"Terminées",-1))])])]),_:1}),r(u,{class:"text-center"},{content:l(()=>[t("div",Z,[e[12]||(e[12]=t("div",{class:"p-3 bg-red-100 rounded-full mr-4"},[t("i",{class:"pi pi-exclamation-triangle text-red-600 text-xl"})],-1)),t("div",null,[t("div",tt,a(s(n).enAttente),1),e[11]||(e[11]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400"},"En attente",-1))])])]),_:1})]),t("div",et,[r(u,null,{header:l(()=>[t("div",st,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"Répartition des statuts",-1)),T(r(p,{icon:"pi pi-refresh",text:"",rounded:"",size:"small",onClick:j},null,512),[[A,"Actualiser",void 0,{top:!0}]])])]),content:l(()=>[s(b)?(d(),c("div",rt,[r(k,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):(d(),c("div",nt,[t("div",it,[e[14]||(e[14]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"En cours",-1)),t("span",ot,a(s(n).enCours),1)]),r(y,{value:s(n).total>0?s(n).enCours/s(n).total*100:0,showValue:!1,style:{height:"8px"},class:"mb-2"},null,8,["value"]),t("div",lt,[e[15]||(e[15]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Terminées",-1)),t("span",at,a(s(n).terminees),1)]),r(y,{value:s(n).total>0?s(n).terminees/s(n).total*100:0,showValue:!1,style:{height:"8px"},class:"mb-2 !bg-green-500"},null,8,["value"]),t("div",dt,[e[16]||(e[16]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"En attente",-1)),t("span",ct,a(s(n).enAttente),1)]),r(y,{value:s(n).total>0?s(n).enAttente/s(n).total*100:0,showValue:!1,style:{height:"8px"}},null,8,["value"])]))]),_:1}),r(u,null,{header:l(()=>[t("div",ut,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"Activité récente",-1)),r(p,{label:"Voir tout",icon:"pi pi-arrow-right",text:"",size:"small",onClick:e[0]||(e[0]=o=>i.$router.push("/interventions"))})])]),content:l(()=>[s(b)?(d(),c("div",pt,[r(k,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):s(x).length===0?(d(),c("div",xt,e[18]||(e[18]=[t("i",{class:"pi pi-info-circle text-2xl mb-2"},null,-1),t("p",null,"Aucune intervention récente",-1)]))):(d(),c("div",mt,[(d(!0),c(N,null,z(s(x),o=>(d(),c("div",{key:o.id,class:"flex items-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors cursor-pointer",onClick:wt=>i.$router.push(`/interventions/${o.id}`)},[t("div",yt,[r(C,{value:o.statut,severity:w(o.statut),size:"small"},null,8,["value","severity"])]),t("div",vt,[t("p",ft,a(o.titre),1),t("p",_t,a(o.client_nom)+" • "+a($(o.date_creation)),1)]),e[19]||(e[19]=t("div",{class:"flex-shrink-0"},[t("i",{class:"pi pi-chevron-right text-gray-400"})],-1))],8,gt))),128))]))]),_:1})]),r(u,null,{header:l(()=>e[20]||(e[20]=[t("div",{class:"p-4 border-b"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},"Actions rapides")],-1)])),content:l(()=>[t("div",bt,[t("div",kt,[r(p,{label:"Nouvelle intervention",icon:"pi pi-plus",class:"p-button-primary justify-start",onClick:e[1]||(e[1]=o=>i.$router.push("/interventions/create"))}),r(p,{label:"Mes interventions",icon:"pi pi-list",class:"p-button-outlined justify-start",onClick:e[2]||(e[2]=o=>i.$router.push("/interventions"))}),r(p,{label:"Gestion clients",icon:"pi pi-users",class:"p-button-outlined justify-start",onClick:e[3]||(e[3]=o=>i.$router.push("/clients"))}),s(v)?.role==="admin"||s(v)?.role==="manager"?(d(),I(p,{key:0,label:"Gestion utilisateurs",icon:"pi pi-user-edit",class:"p-button-outlined justify-start",onClick:e[4]||(e[4]=o=>i.$router.push("/users"))})):L("",!0)])])]),_:1})])])])}}};export{Lt as default};
