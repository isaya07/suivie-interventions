import{_ as D}from"./CyJ7lqwL.js";import M from"./D5k--mLm.js";import{r as g,j as N,c as a,b as x,a as e,h as w,w as k,i as s,n as h,t as y,o as i,f as _,k as d,v as u}from"./DYlgVOq5.js";import{u as S}from"./DFhEUFyw.js";import{u as T}from"./DSFzkygU.js";import"./TrVZK8xw.js";import"./Bo_PBiFp.js";import"./Bjy1Ed27.js";import"./8hyyyOHM.js";import"./BwzGxkg-.js";import"./CBaYzeil.js";import"./DlAUqK2U.js";const R={class:"max-w-4xl mx-auto py-6 sm:px-6 lg:px-8"},A={class:"px-4 py-6 sm:px-0"},B={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},F={class:"lg:col-span-2"},I={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},L={key:0},z={class:"flex justify-end"},G=["disabled"],H={key:0},J={key:1},K={class:"p-6 space-y-4"},O={class:"mt-1 text-sm text-gray-900"},Q={key:0},W={class:"mt-1 text-sm text-gray-900"},X=["disabled"],Y={key:0},Z={key:1},$={key:0,class:"fixed bottom-4 right-4 max-w-sm"},ce={__name:"profile",setup(ee){const{user:l}=S(),{updateUser:P}=T(),b=g(!1),f=g(!1),c=g(null),n=g({prenom:"",nom:"",email:"",telephone:"",specialite:""}),m=g({newPassword:"",confirmPassword:""});N(()=>{if(l.value){const[o,...t]=(l.value.nom_complet||"").split(" ");n.value={prenom:o||"",nom:t.join(" ")||"",email:l.value.email||"",telephone:l.value.telephone||"",specialite:l.value.specialite||""}}});const V=async()=>{b.value=!0;try{const o=await P(l.value.id,n.value);o.success?p("Profil mis à jour avec succès","success"):p(o.message||"Erreur lors de la mise à jour","error")}catch{p("Erreur lors de la mise à jour","error")}finally{b.value=!1}},C=async()=>{if(m.value.newPassword!==m.value.confirmPassword){p("Les mots de passe ne correspondent pas","error");return}f.value=!0;try{p("Fonctionnalité à implémenter","error")}catch{p("Erreur lors du changement de mot de passe","error")}finally{f.value=!1}},p=(o,t="success")=>{c.value={text:o,type:t},setTimeout(()=>{c.value=null},5e3)},U=o=>({admin:"bg-red-100 text-red-800",manager:"bg-purple-100 text-purple-800",technicien:"bg-blue-100 text-blue-800",client:"bg-gray-100 text-gray-800"})[o]||"bg-gray-100 text-gray-800",E=o=>({admin:"Administrateur",manager:"Manager",technicien:"Technicien",client:"Client"})[o]||o,j=o=>o?new Date(o).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return(o,t)=>{const q=D,v=M;return i(),a("div",null,[x(q),e("main",R,[e("div",A,[t[20]||(t[20]=e("div",{class:"mb-8"},[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},"Mon Profil"),e("p",{class:"text-gray-600 dark:text-gray-400"},"Gérer vos informations personnelles")],-1)),e("div",B,[e("div",F,[x(v,null,{content:k(()=>[t[12]||(t[12]=e("div",{class:"p-6 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Informations personnelles")],-1)),e("form",{onSubmit:_(V,["prevent"]),class:"p-6 space-y-6"},[e("div",I,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700"},"Prénom",-1)),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>s(n).prenom=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[u,s(n).prenom]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>s(n).nom=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[u,s(n).nom]])])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>s(n).email=r),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[u,s(n).email]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700"},"Téléphone",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>s(n).telephone=r),type:"tel",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[u,s(n).telephone]])]),s(l)?.role==="technicien"?(i(),a("div",L,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Spécialité",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s(n).specialite=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Ex: Électricité, Plomberie, Informatique..."},null,512),[[u,s(n).specialite]])])):w("",!0),e("div",z,[e("button",{type:"submit",disabled:s(b),class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-2 px-4 rounded-lg transition-colors"},[s(b)?(i(),a("span",H,"Enregistrement...")):(i(),a("span",J,"Enregistrer les modifications"))],8,G)])],32)]),_:1})]),e("div",null,[x(v,null,{content:k(()=>[t[16]||(t[16]=e("div",{class:"p-6 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Informations du compte")],-1)),e("div",K,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom d'utilisateur",-1)),e("p",O,y(s(l)?.username),1)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Rôle",-1)),e("span",{class:h(["mt-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",U(s(l)?.role)])},y(E(s(l)?.role)),3)]),s(l)?.last_login?(i(),a("div",Q,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Dernière connexion",-1)),e("p",W,y(j(s(l).last_login)),1)])):w("",!0)])]),_:1}),x(v,{class:"mt-6"},{content:k(()=>[t[19]||(t[19]=e("div",{class:"p-6 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Sécurité")],-1)),e("form",{onSubmit:_(C,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nouveau mot de passe",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>s(m).newPassword=r),type:"password",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:"",minlength:"6"},null,512),[[u,s(m).newPassword]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Confirmer le mot de passe",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>s(m).confirmPassword=r),type:"password",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:"",minlength:"6"},null,512),[[u,s(m).confirmPassword]])]),e("button",{type:"submit",disabled:s(f),class:"w-full bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded-lg transition-colors"},[s(f)?(i(),a("span",Y,"Changement...")):(i(),a("span",Z,"Changer le mot de passe"))],8,X)],32)]),_:1})])]),s(c)?(i(),a("div",$,[e("div",{class:h(["bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",s(c).type==="error"?"bg-red-100 border-red-400 text-red-700":""])},y(s(c).text),3)])):w("",!0)])])])}}};export{ce as default};
